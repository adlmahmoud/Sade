{{define "best_track"}}
<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Meilleurs titres</title>
    <link rel="stylesheet" href="/static/css/global.css">
    <link rel="stylesheet" href="/static/css/best_tracks.css">
</head>
<body class="page--tracks">
    <div class="page-shell">
        <header class="page-header">
            <div>
                <div class="page-title">Meilleurs titres</div>
                <p class="page-subtitle">Les morceaux qui capturent l'essence de Sade.</p>
            </div>
            <nav class="page-nav">
                <a href="/">Artiste</a>
                <a href="/albums">Albums</a>
                <a href="#" class="is-primary">Meilleurs titres</a>
            </nav>
        </header>

        <main>
            <section class="card">
                <div class="card-header">
                    <div class="card-title">Titres</div>
                </div>

                <div class="table-shell" id="tracks-table">
                    <table>
        <thead>
            <tr>
                <th>Pochette</th>
                <th>Titre</th>
                <th>Artistes</th>
                <th>Album</th>
                <th>Durée (ms)</th>
                <th>Popularité</th>
                <th>Preview</th>
                <th>Spotify</th>
            </tr>
        </thead>
        <tbody>
            {{range .Tracks}}
            {{/* On mémorise le nom de l'album pour l'utiliser dans l'alt */}}
            {{$albumName := .Album.Name}}
            <tr>
                <td>
                    {{if gt (len .Album.Images) 0}}
                        {{with index .Album.Images 0}}
                            <img src="{{.URL}}" alt="{{$albumName}}">
                        {{end}}
                    {{end}}
                </td>
                <td>{{.Name}}</td>
                <td class="artists">
                    {{range .Artists}}
                        <span>{{.Name}}</span>
                    {{end}}
                </td>
                <td>{{.Album.Name}}</td>
                <td>{{.DurationMs}}</td>
                <td>{{.Popularity}}</td>
                <td>
                    {{if .PreviewURL}}
                        <audio controls src="{{.PreviewURL}}"></audio>
                    {{else}}
                        Pas de preview disponible
                    {{end}}
                </td>
                <td>
                    <a href="https://open.spotify.com/track/{{.ID}}" target="_blank" rel="noopener noreferrer">
                        Ouvrir dans Spotify
                    </a>
                </td>
            </tr>
            {{end}}
        </tbody>
                    </table>
                </div>
            </section>
        </main>

        <footer style="margin-top: 18px; text-align: left;">
            <a href="/" class="link-ghost">&#8592; Retour à l'accueil</a>
        </footer>
    </div>

    <script src="/static/js/best_tracks.js" defer></script>
</body>
</html>
{{end}}
